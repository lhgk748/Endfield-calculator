<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>终末地养成计算器</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- 网页表头 -->
    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
        <h1 style="margin: 0;">💻终末地角色武器养成计算器</h1>
        <button id="nightModeToggle" style="background: none; border: none; font-size: 28px; cursor: pointer; padding: 0 10px;" title="切换夜间模式">🌙</button>
    </div>
    <!-- 导航栏 -->
    <div class="nav-bar">
        <a href="#home" class="nav-link" data-page="home">🏠 首页</a>
        <a href="#table" class="nav-link" data-page="table">🗄️干员等级养成计算</a>
        <a href="#operator" class="nav-link" data-page="operator">🦉干员技能养成计算</a>
        <a href="#weapon" class="nav-link" data-page="weapon">⚔️武器养成计算</a>
        <a href="#plan" class="nav-link" data-page="plan">📊 体力规划</a>
        <a href="#stock" class="nav-link" data-page="stock">📦 库存（需手动填写）</a>
        <a href="#settings" class="nav-link" data-page="settings">⚙️ 设置</a>
    </div>
    
        <!-- 首页页面 -->
    <div id="page-home" class="page active">
        <div class="panel" style="background: #e2f0d9;">
            <h2>欢迎使用终末地养成计算器</h2>
            <p style="margin:0 0 8px 0; color: black;"><strong> 使用说明：</strong></p>
            <ul style="margin:0 0 8px 20px; color: black; padding-left:0;">
                <li style="margin:8px 0; list-style-type: none;">本计算器可一键规划干员、武器升级所需材料</li>            
                <li style="margin:8px 0; list-style-type: none;">体力规划需在体力规划界面设置，默认体力上限为350（对应探索等级7）</li> 
            </ul>
            <h6 style="text-align: right;">by森空岛轮回过客。</h6>
        </div>
    </div>

    <!-- 干员等级养成页面 -->
    <div id="page-table" class="page">
        <!-- 数据说明 -->
        <div class="panel" style="background: #e2f0d9;">
            <p style="margin:0 0 8px 0; color: #1e7e34;"><strong>📍使用前必看：</strong></p>
            <ul style="margin:0 0 8px 20px; color: #1e7e34; padding-left:0;">
                <li style="margin:2px 0;">战斗技能最高12级，专精1=10，专精2=11，专精3=12</li>
                <li style="margin:2px 0;">装备适配：绿装=0，蓝装=1，紫装=2，金装=3</li>
                <li style="margin:2px 0;">装备适配与精英化单独计算，请选择多次添加</li>
                <li style="margin:2px 0;">基建技能为帝江号相关技能</li>
            </ul>
            <p style="margin:0; color: #1e7e34;">待补充</p>
        </div>

        <!-- 输入区域 -->
        <div class="panel">

            <div class="form-row">
                <label>干员：</label>
                <select id="operatorSelect">
                    <option value="">请选择</option>
                </select>
            </div>

            <div class="form-row">
                <label>升级项目：</label>
                <select id="projectSelect" disabled>
                    <option value="">先选干员</option>
                </select>
            </div>

            <div class="form-row">
                <label>现等级：</label>
                <input type="number" id="currentLevel" min="0" max="90" value="">
                <label>目标等级：</label>
                <input type="number" id="targetLevel" min="0" max="90" value="">
                <button id="calcBtn">计算材料</button>
            </div>

            <div id="levelOptions" style="display: none; margin-top: 10px;">
                <div id="eliteOption">
                    <label><input type="checkbox" id="includeElite"> 当前阶段已精英化</label>
                </div>
                <div id="adaptOptions">
                    <label><input type="checkbox" id="adapt0Done"> 已可穿戴蓝装？</label>
                    <label style="margin-left: 20px;"><input type="checkbox" id="adapt1Done"> 已可穿戴紫装？</label>
                    <label style="margin-left: 20px;"><input type="checkbox" id="adapt2Done"> 已可穿戴金装？</label>
                </div>
            </div>
        </div>

        <!-- 培养计划列表 -->
        <div class="panel">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <h3 style="margin: 0;">培养计划列表</h3>
                <div>
                    <button id="removeAllBtn" style="background-color: #dc3545; margin-left: 10px;">🗑️ 一键移除全部</button>
                </div>
            </div>
            <div class="plan-table-wrapper" style="overflow-x: auto;">
                <table id="planTable">
                    <thead>
                        <tr>
                            <th></th>
                            <th>移除</th>
                            <th>完成</th>
                            <th>隐藏</th>
                            <th>干员</th>
                            <th>升级项目</th>
                            <th>现等级</th>
                            <th>目标等级</th>
                            <!-- 材料列JS生成 -->
                        </tr>
                    </thead>
                    <tbody id="planBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 干员技能养成添加页面 -->
    <div id="page-operator" class="page">
        <div class="panel" style="background: #abebc6;">
               <p style="margin:0 0 8px 0; color: #1e7e34;"><strong>📍使用说明</strong></p>
               <ul style="margin:0 0 8px 20px; color: #1e7e34; padding-left:0;">
                <li style="margin:2px 0;">可自由设置初始等级和最终等级</li>
                <li style="margin: 2px 0;">也可一键满级</li>
            </ul>
        </div>

        <div class="panel">
            <h2>干员一键规划</h2>
            <div class="form-row">
                <label>干员：</label>
                <select id="addOperatorSelect"></select>
            </div>

            <!-- 快捷满级 -->
            <div class="quick-options" style="margin: 15px 0;">
                <button class="quick-btn" data-target="full">全满</button>
            </div>

            <!-- 生成满级所需材料的表格 -->
            <div style="overflow-x: auto;">
                <table id="operatorProjectTable" style="width: max-content; border-collapse: collapse; margin-bottom:20px;">
                    <thead id="operatorProjectHeader">
                        <!-- 动态生成列名 -->
                    </thead>
                    <tbody id="operatorProjectBody">
                        <!-- 动态生成两行：目前等级行和培养目标行 -->
                    </tbody>
                </table>
            </div>

            <!-- 计算需求按钮 -->
            <button id="calcDemandBtn" style="margin-right:10px;">🛒 计算总需求</button>
            <button id="addAllToPlannerBtn">🧮 全部添加到计算器</button>

            <!-- 计算材料-->
            <div id="demandMaterials" style="margin-top:20px;">
                <h3>需求材料</h3>
                <table style="width:100%; border-collapse: collapse;">
                    <thead>
                        <tr>
                            <th>升级项目</th>
                            <th>现等级</th>
                            <th>目标等级</th>
                            <th>所需材料</th>
                        </tr>
                    </thead>
                    <tbody id="demandBody">
                        <!-- 动态生成 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 武器养成计算页面 -->
    <div id="page-weapon" class="page">
        <div class="panel">
            <h2>武器一键养成</h2>
            <div class="form-row">
                <label>星级：</label>
                <select id="weaponStarSelect">
                    <option value="0">全部</option>
                    <option value="3">3星</option>
                    <option value="4">4星</option>
                    <option value="5">5星</option>
                    <option value="6">6星</option>
                </select>
            </div>
            <div class="form-row">
                <label>武器：</label>
                <select id="weaponSelect">
                    <!-- 武器列表由 JS 动态生成 -->
                </select>
            </div>

            <!-- 快捷突破 -->
            <div class="quick-options" style="margin: 15px 0;">
                <button class="quick-btn" data-target="break0">20级突破0</button>
                <button class="quick-btn" data-target="break1">40级突破1</button>
                <button class="quick-btn" data-target="break2">60级突破2</button>
                <button class="quick-btn" data-target="break3">80级突破3</button>
                <button class="quick-btn" data-target="full">90级突破4</button>
            </div>

            <!-- 突破阶段 + 等级 -->
            <div style="overflow-x: auto;">
                <table id="weaponProjectTable" style="width: max-content; border-collapse: collapse; margin-bottom:20px;">
                    <thead id="weaponProjectHeader">
                        <!-- 动态生成列名：突破阶段、等级 -->
                    </thead>
                    <tbody id="weaponProjectBody">
                        <!-- 目前等级、培养目标 -->
                    </tbody>
                </table>
            </div>

            <!-- 计算需求按钮 -->
            <button id="calcWeaponDemandBtn" style="margin-right:10px;">🛒 计算总需求</button>
            <button id="addWeaponToPlannerBtn">🧮 全部添加到计算器</button>

            <!-- 需求材料列表 -->
            <div id="weaponDemandMaterials" style="margin-top:20px;">
                <h3>需求材料</h3>
                <table style="width:100%; border-collapse: collapse;">
                    <thead>
                        <tr>
                            <th>升级项目</th>
                            <th>现等级</th>
                            <th>目标等级</th>
                            <th>所需材料</th>
                        </tr>
                    </thead>
                    <tbody id="weaponDemandBody">
                        <!-- 动态生成 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 体力规划页面 -->
    <div id="page-plan" class="page">
        <div class="panel">
            <!-- 内容由 JS 动态生成 -->
        </div>
    </div>

    <!-- 库存页面 -->
    <div id="page-stock" class="page">
        <div class="panel">
            <h2>库存管理（需对照游戏内仓库填写）</h2>
            <table id="stockTable">
                <thead><tr><th>材料</th><th>库存</th></tr></thead>
                <tbody id="stockBody"></tbody>
            </table>
            <button id="saveStockBtn">保存库存</button>
        </div>
    </div>

    <!-- 设置页面（数据备份） -->
    <div id="page-settings" class="page">
        <div class="panel">
            <h2>数据备份</h2>

            <!-- 探索等级选择 -->
            <div class="form-row" style="margin-bottom: 20px;">
                <label for="exploreLevelSelect">玩家探索等级：</label>
                <select id="exploreLevelSelect">
                    <option value="1">1级</option>
                    <option value="2">2级</option>
                    <option value="3">3级</option>
                    <option value="4">4级</option>
                    <option value="5">5级</option>
                    <option value="6">6级</option>
                    <option value="7">7级</option>
                </select>
            </div>

            <!-- 每日体力上限 -->
            <div class="form-row" style="margin-bottom: 20px;">
                <label for="dailyStaminaInput">每日体力上限：</label>
                <input type="number" id="dailyStaminaInput" min="120" max="360" value="350" style="width: 80px;">
                <span style="margin-left: 10px; color: #6c757d;">（用于计算天数）</span>
            </div>

            <hr>
            <p>导出全部数据（计划+库存）或从备份恢复。（数据存储在网页缓存中）</p>
            <button id="generateBackup">📄 生成备份</button>
            <button id="applyBackup">🔄 应用备份</button>
            <br><br>
            <textarea id="backupText" rows="8" style="width:100%; font-family: monospace; padding:8px; box-sizing:border-box;" placeholder="备份数据将显示在这里..."></textarea>
            <br><br>
            <p style="color: #6c757d;">提示：可复制上方文本保存，或将保存的文本粘贴后点击“应用备份”。</p>
        </div>
    </div>

    <!-- 底部文字叙述 -->
    <div class="footer-note">
         <p>📢 本网站所使用的游戏图片、图标等素材，其版权均归属于《终末地》官方及其版权方。所有素材仅用于玩家交流与工具展示，绝非商业用途。</p>
    </div>
<!-- 依赖库 -->
    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/router.js"></script>        <!-- 依赖 DOM，但无其他依赖 -->
    <script src="js/planner.js"></script>       <!-- 依赖 data.js, utils.js, router.js 中的函数 -->
    <script src="js/operatorAdd.js"></script>   <!-- 依赖 data.js, utils.js, planner.js 中的 addPlanRow 等 -->
    <script src="js/weaponAdd.js"></script>     <!-- 依赖 data.js, planner.js 中的函数 -->
    <script src="js/plan.js"></script>          <!-- 依赖 data.js, plan.js 中的函数 -->
    <script src="js/stock.js"></script>         <!-- 依赖 planner.js 中的 updateExpValues 等 -->
    <script src="js/settings.js"></script>      <!-- 依赖 planner.js 中的 addPlanRow 等 -->
    <script src="js/main.js"></script>          <!-- 最后执行，调用各 init 函数 -->
</body>
</html>